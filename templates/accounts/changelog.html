{% extends 'base.html' %}
{% load static %}

{% block title %}Changelog - Reflekt{% endblock %}

{% block extra_css %}
<link href="{% static 'css/pages/changelog.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="text-center mb-5">
                <h1 class="display-5 fw-bold"><i class="bi bi-journal-code me-2"></i>Changelog</h1>
                <p class="text-muted lead">Version history and release notes for Reflekt</p>
            </div>

            <div class="changelog-container">

                <!-- V1.01.3 - January 9, 2026 -->
                <div class="changelog-version">
                    <div class="version-header" data-bs-toggle="collapse" data-bs-target="#v1-01-3" aria-expanded="true">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="version-badge">V1.01.3</span>
                                <span class="version-date">January 9, 2026</span>
                            </div>
                            <i class="bi bi-chevron-down collapse-icon"></i>
                        </div>
                    </div>
                    <div class="collapse show" id="v1-01-3">
                        <div class="version-content">
                            <div class="change-category">
                                <h6><i class="bi bi-heart-pulse me-2"></i>Fitness Goals & Body Metrics</h6>
                                <ul>
                                    <li><strong>Fitness Goals:</strong> Set and track fitness goals with progress logging</li>
                                    <li><strong>Body Metrics:</strong> Track weight, body fat, measurements, and more</li>
                                    <li><strong>Cardio Logging:</strong> Log cardio workouts with duration, distance, and calories</li>
                                    <li><strong>Better Measurements:</strong> Comprehensive body measurement tracking for fitness progress</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-phone me-2"></i>Mobile View Improvements</h6>
                                <ul>
                                    <li><strong>Responsive Fixes:</strong> Fixed various layout issues on mobile devices</li>
                                    <li><strong>Cellphone View:</strong> Improved sidebar and navigation on smaller screens</li>
                                    <li><strong>Touch Friendly:</strong> Better touch targets and spacing for mobile users</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-bug me-2"></i>Bug Fixes</h6>
                                <ul>
                                    <li><strong>EasyMDE Auto-Scroll:</strong> Fixed cursor visibility issue in Markdown editor on Safari</li>
                                    <li><strong>Safari Compatibility:</strong> Resolved flex layout height constraints for proper scrolling</li>
                                    <li><strong>Cross-Browser:</strong> Editor now works consistently across Firefox, Safari, and Chrome</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- V1.01.2 - January 5, 2026 -->
                <div class="changelog-version">
                    <div class="version-header collapsed" data-bs-toggle="collapse" data-bs-target="#v1-01-2" aria-expanded="false">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="version-badge">V1.01.2</span>
                                <span class="version-date">January 5, 2026</span>
                            </div>
                            <i class="bi bi-chevron-down collapse-icon"></i>
                        </div>
                    </div>
                    <div class="collapse" id="v1-01-2">
                        <div class="version-content">
                            <div class="change-category">
                                <h6><i class="bi bi-cloud-sun me-2"></i>Weather Analysis Overhaul</h6>
                                <ul>
                                    <li><strong>Historical Weather API:</strong> Implemented Open-Meteo free API for accurate historical weather data</li>
                                    <li><strong>Bug Fix:</strong> Fixed issue where all entries showed current weather (63¬∞F) instead of actual historical data</li>
                                    <li><strong>Temperature Fix:</strong> Corrected Celsius to Fahrenheit conversion in temperature range grouping</li>
                                    <li><strong>Weather Variety:</strong> Now properly shows all weather conditions (clear, clouds, rain, drizzle, snow)</li>
                                    <li><strong>Accurate Data:</strong> Temperature range now spans 27¬∞F - 91¬∞F (previously all 63¬∞F)</li>
                                    <li><strong>1,377 Entries Updated:</strong> Backfilled all existing entries with correct historical weather</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-layout-three-columns me-2"></i>Dashboard Weather Display</h6>
                                <ul>
                                    <li><strong>Horizontal Columns:</strong> Weather impact now displays in 5 horizontal temperature columns</li>
                                    <li><strong>Temperature Ranges:</strong> &lt;30¬∞, 30-59¬∞, 60-79¬∞, 80-99¬∞, ‚â•100¬∞ (in Fahrenheit)</li>
                                    <li><strong>All Conditions Shown:</strong> Changed from top 3 to showing all weather conditions per range</li>
                                    <li><strong>Clickable Conditions:</strong> Click any weather condition to see matching journal entries</li>
                                    <li><strong>Entry Modals:</strong> Beautiful modal popups showing entry previews with mood, date, temperature, sentiment</li>
                                    <li><strong>Visual Enhancements:</strong> Hover effects, color-coded sentiments, smooth animations</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-calendar-check me-2"></i>Monthly Snapshot Reliability</h6>
                                <ul>
                                    <li><strong>Fixed Dashboard Stats:</strong> "This Month's Mood" chart now updates immediately after creating entries</li>
                                    <li><strong>Synchronous Updates:</strong> Monthly snapshots update in real-time without requiring Celery</li>
                                    <li><strong>Entry Count Accuracy:</strong> Dashboard always shows correct number of entries for current month</li>
                                    <li><strong>Mood Distribution Fix:</strong> Mood chart reflects all entries, not stale data</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-gear me-2"></i>Analysis Improvements</h6>
                                <ul>
                                    <li><strong>Complete Sync Analysis:</strong> Synchronous analysis now includes moon phase, weather, and zodiac data</li>
                                    <li><strong>Historical Weather for New Entries:</strong> All new entries automatically get accurate historical weather</li>
                                    <li><strong>Immediate Updates:</strong> Dashboard statistics update instantly when entries are created or edited</li>
                                    <li><strong>Works Offline:</strong> Analysis and updates work whether Celery is running or not</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-link-45deg me-2"></i>API Endpoints</h6>
                                <ul>
                                    <li><strong>New Endpoint:</strong> <code>/api/weather/&lt;temp_range&gt;/&lt;condition&gt;/entries/</code> for filtered weather entries</li>
                                    <li><strong>Entry Filtering:</strong> Get entries by both temperature range and weather condition</li>
                                    <li><strong>Modal Integration:</strong> Backend support for interactive weather condition modals</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- V1.01.1 - January 5, 2026 -->
                <div class="changelog-version">
                    <div class="version-header collapsed" data-bs-toggle="collapse" data-bs-target="#v1-01-1" aria-expanded="false">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="version-badge">V1.01.1</span>
                                <span class="version-date">January 5, 2026</span>
                            </div>
                            <i class="bi bi-chevron-down collapse-icon"></i>
                        </div>
                    </div>
                    <div class="collapse" id="v1-01-1">
                        <div class="version-content">
                            <div class="change-category">
                                <h6><i class="bi bi-pencil-square me-2"></i>Editor Improvements</h6>
                                <ul>
                                    <li><strong>Auto-Scroll Fix:</strong> Editor now smoothly scrolls to keep cursor visible while typing</li>
                                    <li><strong>EasyMDE (Markdown):</strong> Added intelligent auto-scroll that triggers only when typing</li>
                                    <li><strong>Comfortable Padding:</strong> Increased bottom padding to 50vh for better long-entry editing</li>
                                    <li><strong>No More Hidden Cursor:</strong> Cursor stays comfortably visible with 200px of space below</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-tags me-2"></i>Capture Format Unification</h6>
                                <ul>
                                    <li><strong>Emoji Format:</strong> All captures now use consistent emoji format (e.g., üë§ Ariella, üéØ Exercise More)</li>
                                    <li><strong>Removed Links:</strong> Changed from markdown links to clean emoji + text format</li>
                                    <li><strong>Person:</strong> üë§ Name (previously @Name or [Name](/link))</li>
                                    <li><strong>Place:</strong> üìç Place Name</li>
                                    <li><strong>Book:</strong> üìö Book Title</li>
                                    <li><strong>Goal:</strong> üéØ Goal Name</li>
                                    <li><strong>Habit:</strong> ‚úÖ Habit Name</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-bug me-2"></i>Bug Fixes</h6>
                                <ul>
                                    <li><strong>Capture Pills:</strong> Fixed missing capture pills when selecting existing items</li>
                                    <li><strong>Person/Place Captures:</strong> Now properly creates capture and displays pill at bottom</li>
                                    <li><strong>CSRF Errors:</strong> Added CSRF_TRUSTED_ORIGINS configuration for login issues</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- V1.01 - January 4, 2026 -->
                <div class="changelog-version">
                    <div class="version-header collapsed" data-bs-toggle="collapse" data-bs-target="#v1-01" aria-expanded="false">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="version-badge">V1.01</span>
                                <span class="version-date">January 4, 2026</span>
                            </div>
                            <i class="bi bi-chevron-down collapse-icon"></i>
                        </div>
                    </div>
                    <div class="collapse" id="v1-01">
                        <div class="version-content">
                            <div class="change-category">
                                <h6><i class="bi bi-chat-square-quote me-2"></i>POV (Point of View) Sharing</h6>
                                <ul>
                                    <li><strong>Approval Workflow:</strong> Recipients can now approve POVs before adding to their journal</li>
                                    <li><strong>Flexible Adding:</strong> Choose to add POV to existing entry or create new entry for that date</li>
                                    <li><strong>Delete POVs:</strong> Added ability to permanently delete POVs (with confirmation)</li>
                                    <li><strong>Badge Fix:</strong> Sidebar badge now clears after dismissing or approving POVs</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-youtube me-2"></i>YouTube Embedding</h6>
                                <ul>
                                    <li><strong>New {figure} directive:</strong> Embed YouTube videos in journal entries</li>
                                    <li>Supports all YouTube URL formats (watch, youtu.be, embed)</li>
                                    <li>Optional captions with <code>{figure} URL | caption {/figure}</code></li>
                                    <li>Responsive 16:9 aspect ratio</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-bug me-2"></i>Bug Fixes</h6>
                                <ul>
                                    <li><strong>Duplicate Entries:</strong> Fixed auto-save creating duplicate entries for the same date</li>
                                    <li><strong>Quick Save:</strong> Fixed JavaScript function using wrong API endpoint</li>
                                    <li><strong>Date Deduplication:</strong> Server now checks for existing entries before creating new ones</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-shield-check me-2"></i>Admin Features</h6>
                                <ul>
                                    <li><strong>Email Verification:</strong> Manually verify user email addresses</li>
                                    <li><strong>Password Reset:</strong> Send password reset emails or generate temporary passwords</li>
                                    <li><strong>Prompt Management:</strong> Full CRUD for prompt categories with background images</li>
                                </ul>
                            </div>

                            <div class="change-category">
                                <h6><i class="bi bi-envelope me-2"></i>Password Reset Flow</h6>
                                <ul>
                                    <li>Custom branded email templates for password reset</li>
                                    <li>Custom confirmation pages matching site design</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- V1.00 - Initial Release -->
                <div class="changelog-version">
                    <div class="version-header collapsed" data-bs-toggle="collapse" data-bs-target="#v1-00" aria-expanded="false">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="version-badge">V1.00</span>
                                <span class="version-date">January 2026</span>
                            </div>
                            <i class="bi bi-chevron-down collapse-icon"></i>
                        </div>
                    </div>
                    <div class="collapse" id="v1-00">
                        <div class="version-content">
                            <div class="change-category">
                                <h6><i class="bi bi-rocket-takeoff me-2"></i>Initial Release</h6>
                                <ul>
                                    <li>Journal entries with rich text (Quill) and Markdown (EasyMDE) editors</li>
                                    <li>Daily prompts with customizable categories</li>
                                    <li>Challenges system with multi-day journaling prompts</li>
                                    <li>Goals and Habits tracking</li>
                                    <li>Analytics dashboard with insights</li>
                                    <li>Friend system with POV sharing</li>
                                    <li>Captures: places, workouts, meals, mood tracking</li>
                                    <li>Yearly and monthly calendar views</li>
                                    <li>Premium subscriptions via Stripe</li>
                                    <li>Multi-tenant architecture with data isolation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="text-center mt-5">
                <a href="{% url 'analytics:dashboard' %}" class="btn btn-outline-primary">
                    <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
